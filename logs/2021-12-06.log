2021-12-06 17:22:44 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:22:44 [EDI System] info: SELECT (CASE WHEN EDI_LOG_SEQ LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(EDI_LOG_SEQ)) ELSE EDI_LOG_SEQ END) AS ID FROM DUAL
2021-12-06 17:22:44 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:22:45 [EDI System] info: [{"ID":"2288"}]
2021-12-06 17:22:45 [EDI System] info: saveAllLogger => ID:2288, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:22:45 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:22:45 [EDI System] info: Insert successful 
2021-12-06 17:22:45 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:22:45 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:22:45 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:22:45 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:22:46 [EDI System] info: id: 2288, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:23:05 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:23:06 [EDI System] info: Update successful 
2021-12-06 17:23:06 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2288
2021-12-06 17:23:06 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:23:06 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:23:06 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:23:06 [EDI System] info: []
2021-12-06 17:23:06 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:23:07 [EDI System] info: Update successful 
2021-12-06 17:23:07 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:23:07 [EDI System] info: Insert successful 
2021-12-06 17:24:03 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:24:03 [EDI System] info: SELECT (CASE WHEN EDI_LOG_SEQ LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(EDI_LOG_SEQ)) ELSE EDI_LOG_SEQ END) AS ID FROM DUAL
2021-12-06 17:24:03 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:24:03 [EDI System] info: [{"ID":"2289"}]
2021-12-06 17:24:03 [EDI System] info: saveAllLogger => ID:2289, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:24:03 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:24:03 [EDI System] info: Insert successful 
2021-12-06 17:24:03 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:24:03 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:24:03 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:24:04 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:24:04 [EDI System] info: id: 2289, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:24:11 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:24:11 [EDI System] info: Update successful 
2021-12-06 17:24:11 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2289
2021-12-06 17:24:11 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:24:11 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:24:11 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:24:11 [EDI System] info: []
2021-12-06 17:24:11 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:24:11 [EDI System] info: Update successful 
2021-12-06 17:24:11 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:24:12 [EDI System] info: Insert successful 
2021-12-06 17:25:18 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:25:18 [EDI System] info: SELECT (CASE WHEN EDI_LOG_SEQ LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(EDI_LOG_SEQ)) ELSE EDI_LOG_SEQ END) AS ID FROM DUAL
2021-12-06 17:25:18 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:25:18 [EDI System] info: [{"ID":"2290"}]
2021-12-06 17:25:18 [EDI System] info: saveAllLogger => ID:2290, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:25:18 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:25:18 [EDI System] info: Insert successful 
2021-12-06 17:25:18 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:25:18 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:25:18 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:25:19 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:25:19 [EDI System] info: id: 2290, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:25:25 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:25:25 [EDI System] info: Update successful 
2021-12-06 17:25:25 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2290
2021-12-06 17:25:25 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:25:25 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:25:25 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:25:26 [EDI System] info: []
2021-12-06 17:25:26 [EDI System] info: SELECT (CASE WHEN 2290 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(2290)) ELSE 2290 END) AS ID FROM DUAL
2021-12-06 17:25:26 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:25:26 [EDI System] info: [{"ID":"2290"}]
2021-12-06 17:25:26 [EDI System] info: saveAllLogger => ID:2290, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:25:26 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:25:26 [EDI System] info: Insert successful 
2021-12-06 17:29:17 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:29:17 [EDI System] info: SELECT (CASE WHEN EDI_LOG_SEQ LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(EDI_LOG_SEQ)) ELSE EDI_LOG_SEQ END) AS ID FROM DUAL
2021-12-06 17:29:17 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:29:17 [EDI System] info: [{"ID":"2291"}]
2021-12-06 17:29:17 [EDI System] info: saveAllLogger => ID:2291, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:29:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:29:17 [EDI System] info: Insert successful 
2021-12-06 17:29:17 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:29:17 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:29:17 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:29:17 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:29:18 [EDI System] info: id: 2291, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:29:29 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:29:30 [EDI System] info: Update successful 
2021-12-06 17:29:30 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2291
2021-12-06 17:29:30 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:29:30 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:29:30 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:29:30 [EDI System] info: []
2021-12-06 17:29:31 [EDI System] info: SELECT (CASE WHEN 2291 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(2291)) ELSE 2291 END) AS ID FROM DUAL
2021-12-06 17:29:31 [EDI System] info: SELECT (CASE WHEN :ID1 LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:ID2)) ELSE :ID3 END) AS ID FROM DUAL
2021-12-06 17:29:31 [EDI System] info: [{"ID":"2291"}]
2021-12-06 17:29:31 [EDI System] info: saveAllLogger => ID:2291, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:29:31 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:29:31 [EDI System] info: Insert successful 
2021-12-06 17:39:51 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:39:51 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:39:51 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:39:51 [EDI System] info: [{"ID":2292}]
2021-12-06 17:39:51 [EDI System] info: seq : return Key [{"ID":2292}]
2021-12-06 17:39:51 [EDI System] info: saveAllLogger => ID:2292, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:39:51 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:39:51 [EDI System] info: Insert successful 
2021-12-06 17:39:51 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:39:51 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:39:51 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:39:52 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:39:52 [EDI System] info: id: 2292, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:40:04 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:40:05 [EDI System] info: Update successful 
2021-12-06 17:40:05 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2292
2021-12-06 17:40:05 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:40:05 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:40:05 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:40:05 [EDI System] info: []
2021-12-06 17:40:05 [EDI System] info: saveAllLogger => ID:2292, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Start FTP(S) : FTP ID=100, FILE ID=2292
2021-12-06 17:40:05 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:40:05 [EDI System] info: saveAllLogger => ID:2292, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:40:05 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:40:05 [EDI System] info: Insert successful 
2021-12-06 17:40:05 [EDI System] error: {"errorNum":1,"offset":0}
2021-12-06 17:40:05 [EDI System] info: 
    SELECT * 
    FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-12-06 17:40:06 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-12-06 17:40:06 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:40:06 [EDI System] info: Update successful 
2021-12-06 17:40:06 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:40:06 [EDI System] info: Insert successful 
2021-12-06 17:42:07 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:42:07 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:42:07 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:42:08 [EDI System] info: [{"ID":2293}]
2021-12-06 17:42:08 [EDI System] info: seq : return Key [{"ID":2293}]
2021-12-06 17:42:08 [EDI System] info: saveAllLogger => ID:2293, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:42:08 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:42:08 [EDI System] info: Insert successful 
2021-12-06 17:42:08 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:42:09 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:42:09 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:42:09 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:42:09 [EDI System] info: id: 2293, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:42:57 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:42:57 [EDI System] info: Update successful 
2021-12-06 17:42:57 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2293
2021-12-06 17:42:57 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:42:57 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:42:57 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:42:57 [EDI System] info: []
2021-12-06 17:42:58 [EDI System] info: saveAllLogger => ID:2293, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Start FTP(S) : FTP ID=100, FILE ID=2293
2021-12-06 17:42:58 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:42:58 [EDI System] info: saveAllLogger => ID:2293, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:42:58 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:42:58 [EDI System] info: Insert successful 
2021-12-06 17:42:58 [EDI System] info: 
    SELECT * 
    FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-12-06 17:42:58 [EDI System] info: Insert successful 
2021-12-06 17:42:58 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-12-06 17:42:58 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:42:58 [EDI System] info: Update successful 
2021-12-06 17:42:58 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:42:59 [EDI System] info: Insert successful 
2021-12-06 17:43:52 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:43:52 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:43:52 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:43:53 [EDI System] info: [{"ID":2294}]
2021-12-06 17:43:53 [EDI System] info: seq : return Key [{"ID":2294}]
2021-12-06 17:43:53 [EDI System] info: saveAllLogger => ID:2294, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:43:53 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:43:53 [EDI System] info: Insert successful 
2021-12-06 17:43:53 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:43:53 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:43:53 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:43:53 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:43:54 [EDI System] info: id: 2294, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:44:00 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:44:01 [EDI System] info: Update successful 
2021-12-06 17:44:01 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2294
2021-12-06 17:44:01 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:44:01 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:44:01 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:44:01 [EDI System] info: []
2021-12-06 17:44:01 [EDI System] info: saveAllLogger => ID:2294, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:44:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:44:01 [EDI System] info: Insert successful 
2021-12-06 17:46:19 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:46:19 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:46:19 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:46:19 [EDI System] info: [{"ID":2295}]
2021-12-06 17:46:19 [EDI System] info: seq : return Key [{"ID":2295}]
2021-12-06 17:46:19 [EDI System] info: saveAllLogger => ID:2295, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:46:19 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:46:19 [EDI System] info: Insert successful 
2021-12-06 17:46:19 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:46:19 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:46:19 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:46:20 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:46:20 [EDI System] info: id: 2295, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:46:26 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:46:27 [EDI System] info: Update successful 
2021-12-06 17:46:27 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2295
2021-12-06 17:46:27 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:46:27 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:46:27 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:46:27 [EDI System] info: []
2021-12-06 17:46:28 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:46:28 [EDI System] info: saveAllLogger => ID:2295, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:46:28 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:46:28 [EDI System] info: Update successful 
2021-12-06 17:46:28 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:46:28 [EDI System] info: Insert successful 
2021-12-06 17:46:28 [EDI System] info: Insert successful 
2021-12-06 17:54:37 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:54:37 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:54:37 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:54:37 [EDI System] info: [{"ID":2296}]
2021-12-06 17:54:37 [EDI System] info: seq : return Key [{"ID":2296}]
2021-12-06 17:54:37 [EDI System] info: saveAllLogger => ID:2296, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:54:37 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:54:37 [EDI System] info: Insert successful 
2021-12-06 17:54:37 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:54:37 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:54:37 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:54:37 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:54:38 [EDI System] info: id: 2296, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:54:54 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:54:55 [EDI System] info: Update successful 
2021-12-06 17:54:55 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2296
2021-12-06 17:54:55 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:54:55 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:54:55 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:54:55 [EDI System] info: []
2021-12-06 17:54:55 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:54:55 [EDI System] info: saveAllLogger => ID:2296, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:54:55 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:54:56 [EDI System] info: Insert successful 
2021-12-06 17:54:56 [EDI System] info: Update successful 
2021-12-06 17:54:56 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:54:56 [EDI System] info: Insert successful 
2021-12-06 17:55:16 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 17:55:16 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:55:16 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 17:55:17 [EDI System] info: [{"ID":2297}]
2021-12-06 17:55:17 [EDI System] info: seq : return Key [{"ID":2297}]
2021-12-06 17:55:17 [EDI System] info: saveAllLogger => ID:2297, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 17:55:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:55:17 [EDI System] info: Insert successful 
2021-12-06 17:55:17 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 17:55:17 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 17:55:17 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 17:55:17 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 17:55:18 [EDI System] info: id: 2297, name: LOTEVENT_HM2021120617n, query: '본문', process_id: 135
2021-12-06 17:55:24 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 17:55:25 [EDI System] info: Update successful 
2021-12-06 17:55:25 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=984, RESULT=SUCCESS
    WHERE id=2297
2021-12-06 17:55:25 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 17:55:25 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 17:55:25 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 17:55:26 [EDI System] info: []
2021-12-06 17:55:26 [EDI System] info: saveAllLogger => ID:2297, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Start FTP(S) : FTP ID=100, FILE ID=2297
2021-12-06 17:55:26 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:55:26 [EDI System] info: saveAllLogger => ID:2297, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120617n.ff
2021-12-06 17:55:26 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 17:55:26 [EDI System] info: Insert successful 
2021-12-06 17:55:26 [EDI System] error: {"errorNum":1,"offset":0}
2021-12-06 17:55:26 [EDI System] info: 
    SELECT * 
    FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-12-06 17:55:26 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-12-06 17:55:26 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 17:55:26 [EDI System] info: Update successful 
2021-12-06 17:55:26 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 17:55:27 [EDI System] info: Insert successful 
2021-12-06 18:45:12 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 18:45:12 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 18:45:12 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 18:45:12 [EDI System] info: [{"ID":2302}]
2021-12-06 18:45:12 [EDI System] info: seq : return Key [{"ID":2302}]
2021-12-06 18:45:12 [EDI System] info: saveAllLogger => ID:2302, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 18:45:12 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:45:13 [EDI System] info: Insert successful 
2021-12-06 18:45:13 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 18:45:13 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 18:45:13 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 18:45:13 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 18:45:14 [EDI System] info: id: 2302, name: LOTEVENT_HM2021120618n, query: '본문', process_id: 135
2021-12-06 18:45:31 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 18:45:31 [EDI System] info: Update successful 
2021-12-06 18:45:31 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1039, RESULT=SUCCESS
    WHERE id=2302
2021-12-06 18:45:31 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 18:45:32 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 18:45:32 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 18:45:32 [EDI System] info: []
2021-12-06 18:45:32 [EDI System] info: saveAllLogger => ID:2302, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Start FTP(S) : FTP ID=100, FILE ID=2302
2021-12-06 18:45:32 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:45:32 [EDI System] info: saveAllLogger => ID:2302, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120618n.ff
2021-12-06 18:45:32 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:45:32 [EDI System] info: Insert successful 
2021-12-06 18:45:32 [EDI System] info: 
    SELECT * 
    FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-12-06 18:45:32 [EDI System] info: Insert successful 
2021-12-06 18:45:32 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-12-06 18:52:33 [EDI System] info: 100 >>> makeFileText Function Execute
2021-12-06 18:52:33 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 18:52:33 [EDI System] info: SELECT EDI_LOG_SEQ.NEXTVAL AS ID FROM DUAL
2021-12-06 18:52:33 [EDI System] info: [{"ID":2303}]
2021-12-06 18:52:33 [EDI System] info: seq : return Key [{"ID":2303}]
2021-12-06 18:52:33 [EDI System] info: saveAllLogger => ID:2303, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Job Start : ID=100, CFG_ID=135, FTP_ENV_ID=100, FILE_NAME=LOTEVENT_HM:todayHH24n, FILE_DESC=SEC LOTEVENT 1/1HR, FILE_CHARSET=utf-8, FILE_TYPE=ff
2021-12-06 18:52:33 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:52:33 [EDI System] info: Insert successful 
2021-12-06 18:52:33 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-12-06 18:52:33 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-12-06 18:52:33 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-12-06 18:52:33 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDD') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-12-06 18:52:34 [EDI System] info: id: 2303, name: LOTEVENT_HM2021120618n, query: '본문', process_id: 135
2021-12-06 18:52:45 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-12-06 18:52:46 [EDI System] info: Update successful 
2021-12-06 18:52:46 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1039, RESULT=SUCCESS
    WHERE id=2303
2021-12-06 18:52:46 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-12-06 18:52:46 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-12-06 18:52:46 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-12-06 18:52:46 [EDI System] info: []
2021-12-06 18:52:46 [EDI System] info: saveAllLogger => ID:2303, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Start FTP(S) : FTP ID=100, FILE ID=2303
2021-12-06 18:52:46 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:52:46 [EDI System] info: saveAllLogger => ID:2303, NAME:LOTEVENT_HM:todayHH24n, ProcessID:135, Description: Make File : File Save Directory: D:/HM_EDI/SEC/OUT/LOTEVENT_HM2021120618n.ff
2021-12-06 18:52:46 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-12-06 18:52:46 [EDI System] info: Insert successful 
2021-12-06 18:52:46 [EDI System] info: Insert successful 
2021-12-06 18:52:46 [EDI System] info: 
    SELECT * 
    FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-12-06 18:52:47 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-12-06 18:52:47 [EDI System] info: UPDATE EDI_LOG SET RESULT = :result, LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-12-06 18:52:47 [EDI System] info: Update successful 
2021-12-06 18:52:47 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
        VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-12-06 18:52:47 [EDI System] info: Insert successful 
