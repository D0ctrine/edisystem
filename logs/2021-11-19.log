2021-11-19 12:03:00 [EDI System] info: Job Start Time > {"min":3,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"3","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:02:45","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"3 * * * *"}
2021-11-19 12:09:01 [EDI System] info: Job Start Time > {"min":9,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"9","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:08:59","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"9 * * * *"}
2021-11-19 12:12:01 [EDI System] info: Job Start Time > {"min":12,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"12","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:11:08","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"12 * * * *"}
2021-11-19 12:12:01 [EDI System] info: [object Object] >>> makeFileText Function Execute
2021-11-19 12:12:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:12:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:12:01 [EDI System] info: [{"ID":null}]
2021-11-19 12:12:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: null
2021-11-19 12:12:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 12:12:01 [EDI System] error: {"errorNum":1400,"offset":99}
2021-11-19 12:15:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 12:18:01 [EDI System] info: Job Start Time > {"min":18,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"18","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:17:34","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"18 * * * *"}
2021-11-19 12:18:01 [EDI System] info: [object Object] >>> makeFileText Function Execute
2021-11-19 12:18:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:18:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:18:01 [EDI System] info: [{"ID":null}]
2021-11-19 12:18:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: null
2021-11-19 12:18:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 12:18:01 [EDI System] error: {"errorNum":1400,"offset":99}
2021-11-19 12:20:00 [EDI System] info: Job Start Time > {"min":20,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"20","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:19:10","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"20 * * * *"}
2021-11-19 12:20:00 [EDI System] info: [object Object] >>> makeFileText Function Execute
2021-11-19 12:20:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:20:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:20:00 [EDI System] info: [{"ID":"655"}]
2021-11-19 12:20:00 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 655
2021-11-19 12:20:00 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 12:20:01 [EDI System] info: Insert successful 
2021-11-19 12:57:00 [EDI System] info: Job Start Time > {"min":57,"hour":12,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"57","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 12:56:32","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"57 * * * *"}
2021-11-19 12:57:00 [EDI System] info: [object Object] >>> makeFileText Function Execute
2021-11-19 12:57:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:57:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 12:57:01 [EDI System] info: [{"ID":"657"}]
2021-11-19 12:57:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 657
2021-11-19 12:57:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 12:57:01 [EDI System] info: Insert successful 
2021-11-19 12:57:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 12:57:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 12:57:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 12:57:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:00:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 13:00:01 [EDI System] info: Job Start Time > {"min":0,"hour":13,"date":19,"month":11,"day":5}
 {"ID":107,"CFG_ID":"143","FILE_NAME":"nCMWIPINF_HM:todayHH24","FILE_DESC":"SEC CMWIPINF 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"ascii","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":"false","SCHEDULE_MIN":"0","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":"2021-11-12 05:17:07","CREATE_USER":"6","UPDATE_DATE":"2021-11-19 08:43:16","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"0 * * * *"}
2021-11-19 13:00:01 [EDI System] info: [object Object] >>> makeFileText Function Execute
2021-11-19 13:00:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:00:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:00:01 [EDI System] info: [{"ID":"659"}]
2021-11-19 13:00:01 [EDI System] info: saveAllLogger > name: nCMWIPINF_HM:todayHH24 / ID: 659
2021-11-19 13:00:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:00:01 [EDI System] info: Insert successful 
2021-11-19 13:00:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 13:00:01 [EDI System] info: [{"ROWNUM":1,"ID":"140","SETTING_ID":"143","KEY":null,"TYPE":"Main","QUERY":"SELECT\n  RPAD(VR_1,  5, ' ')\n, RPAD(VR_2, 30, ' ')\n, RPAD(VR_3, 15, ' ')\n, RPAD(VR_4, 15, ' ')\n, RPAD(VR_5,  2, ' ')\n, RPAD(VR_6,  2, ' ')\n, RPAD(VR_7, 20, ' ')\n, RPAD(VR_8, 30, ' ')\n, RPAD(VR_9, 16, ' ')\n, RPAD(VR_10, 24, ' ')\n, RPAD(VR_11, 14, ' ')\n, RPAD(VR_12,  4, ' ')\n, RPAD(VR_13,  4, ' ')\n, RPAD(VR_14, 10, ' ')\n, RPAD(VR_15, 10, ' ')\n, RPAD(VR_16,  1, ' ')\n, RPAD(VR_17,  2, ' ')\n, RPAD(VR_18, 10, ' ')\n, RPAD(VR_19, 14, ' ')\n, RPAD(VR_20, 20, ' ')\n, RPAD(VR_21, 20, ' ')\n, RPAD(VR_22, 20, ' ')\n, RPAD(VR_23, 20, ' ')\n, RPAD(VR_24, 20, ' ')\n, RPAD(VR_25, 10, ' ')\n, RPAD(VR_26, 10, ' ')\n, RPAD(VR_27,  1, ' ')\n, RPAD(VR_28, 65, ' ')\n, RPAD(VR_29, 14, ' ')\n, RPAD(VR_30,  8, ' ')\n, RPAD(VR_31, 1024, ' ')\nFROM \n(\nSELECT 'LS1HM'   VR_1\n , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER), '-')   VR_2\n , F_GET_ASSY_RUNID(' ', A.LOT_ID, A.LOT_CMF_4)   VR_3\n , NVL(TRIM(A.LOT_CMF_1), '-')   VR_4\n , NVL(TRIM(A.LOT_CMF_5),'-')   VR_5\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'RTN_TYPE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '**')   VR_6\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'HGAK','TZ010HKAB', 'BASIC',\n     DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','BASIC','HMK3','BASIC','HMK9','BASIC','HMK4','BASIC',\n                  NVL(FLOW, '-')))   VR_7\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', '0008','TZ010HKAB', '0003',\n     TRIM(DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','0002','HMK3','0003','HMK9','0006','HMK4','0007',\n                  LPAD((SELECT SEQ_NUM-1 FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND FLOW = A.FLOW AND OPER = A.OPER),4,'0'))))   VR_8\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', '8','TZ010HKAB', '3',\n     NVL((SELECT SEQ_NUM-1 FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND FLOW = A.FLOW AND OPER = A.OPER), '0'))   VR_9\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'PACKING','TZ010HKAB', 'Assy Final Stock',\n     DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','Assy Home Stock','HMK3','Assy Final Stock','HMK9','Test Home Stock','HMK4','Test Final Stock',\n                  NVL((SELECT OPER_DESC FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-')))   VR_10\n , A.OPER_IN_TIME    VR_11\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'ASSY','TZ010HKAB', 'ASSY', DECODE(A.FACTORY, 'HMKT1', 'TEST', 'HMKA1', 'ASSY', '-'))    VR_12\n , NVL((SELECT DECODE(A.OPER||A.FLOW,'TZ010HKAB', SEC_OPER_AREA_COB ,SEC_OPER_AREA) FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-')   VR_13\n , NVL(TRIM(A.QTY_1), 0)   VR_14\n , NVL(TRIM(A.QTY_2), 0)   VR_15\n , 'C'     VR_16\n , F_GET_HOLD_FLAG_CODE(A.LOT_ID, A.MAT_ID, A.HOLD_FLAG, A.HOLD_CODE, 'FLAG' )    VR_17\n , F_GET_HOLD_FLAG_CODE(A.LOT_ID, A.MAT_ID, A.HOLD_FLAG, A.HOLD_CODE, 'CODE' )    VR_18\n , DECODE(A.HOLD_FLAG, 'Y', A.LAST_TRAN_TIME, ' ')    VR_19\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCFCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_20\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCACODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_21\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCTCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_22\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCQCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_23\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'OTHER' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_24\n , NVL((SELECT SUM(DECODE(TRAN_CODE, 'LOSS', (OLD_QTY_1 - QTY_1), QTY_1)) \n               FROM MWIPLOTHIS \n              WHERE LOT_ID = A.LOT_ID \n                AND TRAN_CODE IN ('LOSS', 'TERMINATE')\n                AND HIST_DEL_FLAG = ' '\n                AND TRAN_TIME BETWEEN F_GET_TIME(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'SE') \n                                  AND TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')), 0)         VR_25\n , NVL((SELECT SUM(TOTAL_BONUS_QTY) \n               FROM MWIPLOTBNS \n              WHERE LOT_ID = A.LOT_ID\n                AND TRAN_TIME BETWEEN F_GET_TIME(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'SE') \n                                  AND TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')), 0)    VR_26\n , '-'    VR_27\n , '-'    VR_28\n , TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')     VR_29\n , GET_WORK_DATE_EDI(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'D')  VR_30\n , MESMGR.PK_SEC_MES_IF.MakeInkless_OMS_WIP(A.FACTORY, A.LOT_ID)  VR_31\n  FROM MWIPLOTSTS A\n WHERE 1 = 1\n   AND FACTORY IN ('HMKT1','HMKA1') \n   AND LOT_CMF_2 = 'SE'   \n   AND OWNER_CODE = 'PROD'\n   AND LOT_TYPE = 'W'\n   AND LOT_DEL_FLAG = ' ' \n   AND CREATE_CODE <> 'FREE' \n   AND MAT_ID LIKE 'SE'||(SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME = 'H_SPECIAL_CHAR' AND KEY_1 = '1')\n   AND OPER BETWEEN 'A0000' AND 'TZ010'\n   AND MAT_ID NOT LIKE 'SEKY'||(SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME = 'H_SPECIAL_CHAR' AND KEY_1 = '1')  --- 영업  요청으로 하드코딩 170412. SEKY%\n)","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:33:13","DBTYPE":"MES"}]
2021-11-19 13:00:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 13:00:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:05:00 [EDI System] info: Job Start Time > {"min":5,"hour":13,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"5","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 01:04:57","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"5 * * * *"}
2021-11-19 13:05:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 13:05:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:05:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:05:01 [EDI System] info: [{"ID":"661"}]
2021-11-19 13:05:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 661
2021-11-19 13:05:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:05:01 [EDI System] info: Insert successful 
2021-11-19 13:05:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 13:05:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 13:05:02 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 13:05:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:07:01 [EDI System] info: Job Start Time > {"min":7,"hour":13,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"7","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 01:06:06","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"7 * * * *"}
2021-11-19 13:07:01 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 13:07:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:07:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:07:01 [EDI System] info: [{"ID":"663"}]
2021-11-19 13:07:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 663
2021-11-19 13:07:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:07:01 [EDI System] info: Insert successful 
2021-11-19 13:07:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 13:07:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 13:07:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 13:07:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:07:04 [EDI System] info: id: 663, name: nLOTEVENT_HM2021111913, query: '본문', process_id: 135
2021-11-19 13:07:47 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 13:07:48 [EDI System] info: Update successful 
2021-11-19 13:09:01 [EDI System] info: Job Start Time > {"min":9,"hour":13,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"9","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 01:08:47","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"9 * * * *"}
2021-11-19 13:09:01 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 13:09:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:09:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:09:01 [EDI System] info: [{"ID":"665"}]
2021-11-19 13:09:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 665
2021-11-19 13:09:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:09:01 [EDI System] info: Insert successful 
2021-11-19 13:09:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 13:09:02 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 13:09:02 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 13:09:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:09:02 [EDI System] info: id: 665, name: nLOTEVENT_HM2021111913, query: '본문', process_id: 135
2021-11-19 13:09:45 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 13:09:45 [EDI System] info: Update successful 
2021-11-19 13:09:45 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=835, RESULT=SUCCESS
    WHERE id=665
2021-11-19 13:09:45 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 13:09:46 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 13:09:46 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 13:09:46 [EDI System] info: []
2021-11-19 13:09:46 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:09:46 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:09:46 [EDI System] info: [{"ID":"665"}]
2021-11-19 13:09:46 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111913 / ID: 665
2021-11-19 13:09:46 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:09:46 [EDI System] info: Insert successful 
2021-11-19 13:14:00 [EDI System] info: Job Start Time > {"min":14,"hour":13,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"14","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 01:13:07","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"14 * * * *"}
2021-11-19 13:14:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 13:14:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:00 [EDI System] info: [{"ID":"666"}]
2021-11-19 13:14:00 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 666
2021-11-19 13:14:00 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:14:00 [EDI System] info: Insert successful 
2021-11-19 13:14:00 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 13:14:00 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 13:14:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 13:14:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 13:14:01 [EDI System] info: id: 666, name: nLOTEVENT_HM2021111913, query: '본문', process_id: 135
2021-11-19 13:14:08 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 13:14:08 [EDI System] info: Update successful 
2021-11-19 13:14:08 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=835, RESULT=SUCCESS
    WHERE id=666
2021-11-19 13:14:08 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 13:14:08 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 13:14:08 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 13:14:08 [EDI System] info: []
2021-11-19 13:14:08 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:08 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:08 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:08 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 13:14:09 [EDI System] info: [{"ID":"666"}]
2021-11-19 13:14:09 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111913 / ID: 666
2021-11-19 13:14:09 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:14:09 [EDI System] info: [{"ID":"666"}]
2021-11-19 13:14:09 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111913 / ID: 666
2021-11-19 13:14:09 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 13:14:09 [EDI System] info: Insert successful 
2021-11-19 13:14:09 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 13:14:09 [EDI System] info: Insert successful 
2021-11-19 13:14:09 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 13:14:10 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 13:14:10 [EDI System] info: Update successful 
2021-11-19 13:14:10 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 13:14:10 [EDI System] info: Insert successful 
2021-11-19 13:15:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 15:57:00 [EDI System] info: Job Start Time > {"min":57,"hour":15,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"57","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 03:56:20","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"57 * * * *"}
2021-11-19 15:57:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 15:57:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:00 [EDI System] info: [{"ID":"672"}]
2021-11-19 15:57:00 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 672
2021-11-19 15:57:00 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 15:57:01 [EDI System] info: Insert successful 
2021-11-19 15:57:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 15:57:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 15:57:02 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 15:57:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 15:57:02 [EDI System] info: test!!!!
2021-11-19 15:57:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"2021111914","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"2021111915","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 15:57:03 [EDI System] info: id: 672, name: nLOTEVENT_HM2021111915, query: '본문', process_id: 135
2021-11-19 15:57:53 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 15:57:53 [EDI System] info: Update successful 
2021-11-19 15:57:53 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1102, RESULT=SUCCESS
    WHERE id=672
2021-11-19 15:57:53 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 15:57:53 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 15:57:53 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 15:57:53 [EDI System] info: []
2021-11-19 15:57:54 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:54 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:54 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:54 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 15:57:54 [EDI System] info: [{"ID":"672"}]
2021-11-19 15:57:54 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111915 / ID: 672
2021-11-19 15:57:54 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 15:57:54 [EDI System] info: [{"ID":"672"}]
2021-11-19 15:57:54 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111915 / ID: 672
2021-11-19 15:57:54 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 15:57:54 [EDI System] info: Insert successful 
2021-11-19 15:57:54 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 15:57:54 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 15:57:55 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 15:57:55 [EDI System] error: {"errorNum":1,"offset":0}
2021-11-19 15:57:55 [EDI System] info: Update successful 
2021-11-19 15:57:55 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 15:57:55 [EDI System] info: Insert successful 
2021-11-19 16:06:00 [EDI System] info: Job Start Time > {"min":6,"hour":16,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"6","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 04:05:38","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"6 * * * *"}
2021-11-19 16:06:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 16:06:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:01 [EDI System] info: [{"ID":"674"}]
2021-11-19 16:06:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 674
2021-11-19 16:06:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:06:01 [EDI System] info: Insert successful 
2021-11-19 16:06:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 16:06:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 16:06:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 16:06:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:06:02 [EDI System] info: id: 674, name: nLOTEVENT_HM2021111916, query: '본문', process_id: 135
2021-11-19 16:06:51 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 16:06:51 [EDI System] info: Update successful 
2021-11-19 16:06:51 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1134, RESULT=SUCCESS
    WHERE id=674
2021-11-19 16:06:51 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 16:06:51 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 16:06:51 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 16:06:52 [EDI System] info: []
2021-11-19 16:06:52 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:52 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:52 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:52 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:06:52 [EDI System] info: [{"ID":"674"}]
2021-11-19 16:06:52 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 674
2021-11-19 16:06:52 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:06:52 [EDI System] info: [{"ID":"674"}]
2021-11-19 16:06:52 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 674
2021-11-19 16:06:52 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:06:52 [EDI System] info: Insert successful 
2021-11-19 16:06:52 [EDI System] info: Insert successful 
2021-11-19 16:06:52 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 16:06:52 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 16:06:52 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 16:06:53 [EDI System] info: Update successful 
2021-11-19 16:06:53 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 16:06:53 [EDI System] info: Insert successful 
2021-11-19 16:14:01 [EDI System] info: Job Start Time > {"min":14,"hour":16,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"14","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 04:13:46","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"14 * * * *"}
2021-11-19 16:14:01 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 16:14:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:01 [EDI System] info: [{"ID":"675"}]
2021-11-19 16:14:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 675
2021-11-19 16:14:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:14:02 [EDI System] info: Insert successful 
2021-11-19 16:14:02 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 16:14:02 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 16:14:02 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 16:14:02 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:14:03 [EDI System] info: id: 675, name: nLOTEVENT_HM2021111916, query: '본문', process_id: 135
2021-11-19 16:14:16 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 16:14:16 [EDI System] info: Update successful 
2021-11-19 16:14:16 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1134, RESULT=SUCCESS
    WHERE id=675
2021-11-19 16:14:16 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 16:14:17 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 16:14:17 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 16:14:17 [EDI System] info: []
2021-11-19 16:14:17 [EDI System] info: TEST!!!!
2021-11-19 16:14:17 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"TEXT","QUERY":"2021111915","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"TEXT","QUERY":"2021111916","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:14:17 [EDI System] info: []
2021-11-19 16:14:17 [EDI System] info: ""
2021-11-19 16:14:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:14:17 [EDI System] info: [{"ID":"675"}]
2021-11-19 16:14:17 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 675
2021-11-19 16:14:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:14:17 [EDI System] info: [{"ID":"675"}]
2021-11-19 16:14:17 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 675
2021-11-19 16:14:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:14:17 [EDI System] info: Insert successful 
2021-11-19 16:14:17 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 16:14:17 [EDI System] info: Insert successful 
2021-11-19 16:14:18 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 16:14:18 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 16:14:18 [EDI System] info: Update successful 
2021-11-19 16:14:18 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 16:14:18 [EDI System] info: Insert successful 
2021-11-19 16:15:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 16:19:01 [EDI System] info: Job Start Time > {"min":19,"hour":16,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"19","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 04:18:17","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"19 * * * *"}
2021-11-19 16:19:01 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 16:19:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:01 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:01 [EDI System] info: [{"ID":"676"}]
2021-11-19 16:19:01 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 676
2021-11-19 16:19:01 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:19:01 [EDI System] info: Insert successful 
2021-11-19 16:19:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 16:19:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 16:19:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 16:19:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:19:02 [EDI System] info: id: 676, name: nLOTEVENT_HM2021111916, query: '본문', process_id: 135
2021-11-19 16:19:09 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 16:19:10 [EDI System] info: Update successful 
2021-11-19 16:19:10 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1134, RESULT=SUCCESS
    WHERE id=676
2021-11-19 16:19:10 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 16:19:10 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 16:19:10 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 16:19:10 [EDI System] info: []
2021-11-19 16:19:10 [EDI System] info: TEST!!!!!
2021-11-19 16:19:10 [EDI System] info: []
2021-11-19 16:19:10 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:10 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:10 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:10 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:19:10 [EDI System] info: [{"ID":"676"}]
2021-11-19 16:19:10 [EDI System] info: [{"ID":"676"}]
2021-11-19 16:19:10 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 676
2021-11-19 16:19:10 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:19:10 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 676
2021-11-19 16:19:10 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:19:11 [EDI System] info: Insert successful 
2021-11-19 16:19:11 [EDI System] error: {"errorNum":1,"offset":0}
2021-11-19 16:30:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 16:45:00 [EDI System] info: ========>saveAllLogger Function Start! > id: 000, name: CHECK, process_id: 000, result:SUCCESS, description: 
2021-11-19 16:45:00 [EDI System] info: Job Start Time > {"min":45,"hour":16,"date":19,"month":11,"day":5}
 {"ID":100,"CFG_ID":"135","FILE_NAME":"nLOTEVENT_HM:todayHH24","FILE_DESC":"SEC LOTEVENT 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"utf-8","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":null,"SCHEDULE_MIN":"45","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":null,"CREATE_USER":null,"UPDATE_DATE":"2021-11-19 04:44:53","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"45 * * * *"}
2021-11-19 16:45:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 16:45:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:00 [EDI System] info: [{"ID":"677"}]
2021-11-19 16:45:00 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM:todayHH24 / ID: 677
2021-11-19 16:45:00 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:45:00 [EDI System] info: Insert successful 
2021-11-19 16:45:01 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 16:45:01 [EDI System] info: [{"ROWNUM":1,"ID":"129","SETTING_ID":"135","KEY":null,"TYPE":"Main","QUERY":"SELECT     \n  RPAD(V1, 2,' ')\n, RPAD(V3 , 20,' ')\n, RPAD(NVL(decode(v35, 'N01', 'Multitransfer', V4), ' ') , 30,' ')\n, RPAD(V5 || LPAD(B.MILI_SEC,3,0) , 20,' ')\n, RPAD(V6 , 2,' ')\n, RPAD(V7 , 4,' ')\n, RPAD(V8 , 30,' ')\n, RPAD(V9  , 20,' ')\n, RPAD(V10 , 10,' ')\n, RPAD(V11 , 30,' ')\n, RPAD(V12 , 20,' ')\n, RPAD(V13 , 20,' ')\n, RPAD(V14 , 10,' ')\n, RPAD(V15 , 10,' ')\n, RPAD(V16 , 14,' ')\n, RPAD(V17 , 14,' ')\n, LPAD(V18 , 10,' ')\n, LPAD(V19 , 10,' ')\n, RPAD(V20 , 14,' ')\n, RPAD(V21 , 10,' ')\n, RPAD(V22 , 10,' ')\n, RPAD(V23 , 20,' ')\n, RPAD(nvl(V24,' ') , 20,' ')\n, RPAD(V25 , 30,' ')\n, RPAD(V26 , 30,' ')\n, RPAD(V27 , 20,' ')\n, RPAD(V28 , 20,' ')\n, RPAD(V29 , 65,' ')\n, RPAD(V30 , 10,' ')\n, RPAD(V31 , 2,' ')\n, RPAD(V32 , 20,' ')\n, RPAD(V33 , 14,' ')\n, RPAD(V34 , 10,' ')\n, RPAD(V35 , 10,' ')\n, RPAD(V36 , 255,' ')\n, RPAD(V37 , 255,' ')\n  FROM ( SELECT ROWNUM IDX, \n                        V0,V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14,V15,V16,V17,V18,V19,V20,V21,V22,V23,V24,V25,V26,V27,V28,V29,V30,V31,V32,V33,V34,V35,V36,V37\n           FROM (\n           select * from\n           (           -- 20200121 chulho.wee ; combine except\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1\n                              , 'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut')\n                              --, 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              --, 'Receive', DECODE(A.OLD_OPER,'T0000','RECV_OY_HMK3', 'Receive')\n                              -- , 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_OY', 'Ship')\n                              , 'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct', DECODE(A.OLD_OPER, 'T0100', 'ChangeProduct','T0960','ChangeProduct', B.DATA_1))\n                              , 'Receive', DECODE(A.OLD_OPER||SUBSTR(A.MAT_ID,1,3),'T0000SES','RECV_OY_HMK3','A0000SES','RECV_KH_HMK2', 'Receive')\n                              --, 'Ship', DECODE(A.OLD_OPER,'TZ010','SHIP_HMK4_ASIMACS','AZ010','SHIP_HMK3_OY', 'Ship')\n                              , 'Ship', DECODE(A.OLD_OPER,'TZ010',DECODE(F_GET_HALF_FULL(A.LOT_ID, A.HIST_SEQ), 'Y','SHIP_HMKT_OY', 'SHIP_HMK4_ASIMACS'),'AZ010','SHIP_HMK3_OY', 'Ship')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(B.DATA_1||A.OLD_FACTORY\n                              , 'ReceiveHMKT1', 'HMK3'\n                              , 'ShipHMKT1', 'HMK4'\n                              , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT'))  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.QTY_1),TRIM(A.QTY_1))\n                                    ,TRIM(A.QTY_1))\n                                    , 0)  V19 -- CHIP_QTY_new-- 2010 10 07\n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1),'T',TRIM(A.QTY_1-A.OLD_QTY_1),TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,'SPLIT',DECODE(FROM_TO_FLAG,'F',abs(A.OLD_QTY_1-A.QTY_1),TRIM(A.QTY_1))\n                                                    ,'LOSS',(A.OLD_QTY_1 - QTY_1)\n                                                    ,TRIM(A.QTY_1))\n                                   , 0)  V22 -- EVENT_QTY_new -- 2010 10 07\n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'MERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',-1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',-1))\n                                       )  V25\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , DECODE(TRAN_CODE,'ADAPT',F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,'ADAPT','MAT_ID',1),F_GET_CHG_PREV_VAL(A.LOT_ID,A.HIST_SEQ,TRAN_CODE,'MAT_ID',1))\n                                       )  V26\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'T',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'SPLIT',DECODE(FROM_TO_FLAG,'F',' ',NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , 'MERGE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         \n                 union all\n                       -- 20200121 chulho.wee ; combine only ; merge, multitransfer\n                       SELECT C.IN_DTTM V0, 'HM'  V1\n                     , DECODE(A.FACTORY, 'HMKA1', 'ASSY', 'TEST') V2\n                     , NVL(TRIM(A.LOT_CMF_1), '-') V3\n                     , DECODE(B.DATA_1,\n                              'END', NVL(TRIM(INITCAP(A.TRAN_CMF_1)),'TrackOut'),\n                              'Change', DECODE(A.TRAN_CMF_1,'PART_CHANGE','ChangeProduct')\n                              , B.DATA_1) V4\n                     , A.TRAN_TIME V5 \n                     , NVL(TRIM(A.LOT_CMF_5), '-')  V6\n                     , DECODE(A.FACTORY, 'HMKA1', 'HMKA', 'HMKT')  V7\n                     , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER)\n                          , (SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.OLD_FACTORY AND MAT_ID = A.OLD_MAT_ID AND MAT_VER = A.MAT_VER))  V8\n                     , A.FLOW  V9\n                     , DECODE(SUBSTRB(A.OLD_OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OLD_OPER,1,4))  V10\n                     , NVL((SELECT OPER_DESC FROM MWIPOPRDEF WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW), ' ' )  V11\n                     , NVL((SELECT RES_GRP_3 FROM MRASRESDEF WHERE FACTORY = A.FACTORY AND RES_ID = A.START_RES_ID ),' ')  V12\n                     , NVL(START_RES_ID, ' ')  V13\n                     , NVL((SELECT DECODE(SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(NVL(trim(PREV_OPER), 'A0000'),1,4)) FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND OPER = A.OPER AND FLOW = A.FLOW),' ')  V14\n                     , DECODE(SUBSTRB(A.OPER,1,4),'AZ01','HMK3','T000','HMK3','TZ01','HMK4','A000','HMK2',SUBSTRB(A.OPER,1,4))  V15\n                     , A.OPER_IN_TIME  V16\n                     , A.CREATE_TIME  V17\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V18\n                     , NVL(\n                                    DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.QTY_1+(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' '))\n                                                                                       ,TRIM(A.QTY_1))\n                                                    , TRIM(A.QTY_1))\n                           , 0)  V19 \n                     , A.TRAN_TIME  V20\n                     , NVL(D.WAFERQTY,NVL(TRIM(A.QTY_2),0))  V21\n                     , NVL(\n                                    DECODE(TRAN_CODE,'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.OLD_QTY_1)\n                                                                                  ,'T',(select max(old_qty_1) from mwiplothis where lot_id = (select from_to_lot_id from mwiplothis where lot_id = a.lot_id and hist_seq = a.hist_seq) and tran_code = 'COMBINE' and hist_del_flag = ' ')\n                                                                                  ,TRIM(A.QTY_1)) --,TRIM(A.QTY_1))\n                                                    ,TRIM(A.QTY_1)*2)\n                           , 0)  V22 \n                     , NVL((SELECT LOT_STATE FROM V_SECLOTSTS WHERE FACTORY = A.FACTORY AND LOT_ID = A.LOT_ID AND HIST_SEQ = A.HIST_SEQ ),' ')  V23\n                     , DECODE(TRAN_CODE,'SPLIT',DECODE(FROM_TO_FLAG,'T','Splitted','Split'),\n                                        'COMBINE',DECODE(FROM_TO_FLAG,'T','Merge','Merged'),\n                                        'PMERGE',DECODE(FROM_TO_FLAG,'T','Merge','Merged')\n                                      )  V24\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V25\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.FROM_TO_LOT_ID),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ') V26\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'F',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V27\n                     , DECODE(TRAN_CODE, 'COMBINE',DECODE(FROM_TO_FLAG,'T',TRIM(A.LOT_CMF_1),NVL(TRIM(A.FROM_TO_LOT_ID), TRIM(A.LOT_CMF_1)))\n                                       , ' ')  V28\n                     , ' '  V29\n                     , DECODE(TRAN_CODE, 'HOLD',HOLD_CODE, ' ')  V30\n                     , F_GET_ATTR_VALUE(A.LOT_ID, 'LOT_SEC_INFO','RETURN_CODE')  V31\n                     , NVL(TRIM(A.LOT_CMF_4), '-')  V32\n                     , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')  V33\n                     , A.START_QTY_1  V34\n                     , NVL((SELECT MAX(LOSS_CODE_1) FROM MWIPLOTLOS WHERE FACTORY = A.FACTORY AND OPER = A.OLD_OPER AND FLOW = A.FLOW AND LOT_ID = A.LOT_ID), ' ' )  V35\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V36\n                     , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = 'HMKA1' AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'WORDER' AND ATTR_KEY  = A.LOT_ID ), ' ') V37\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           AND A.OPER LIKE 'A040_'\n              )\n              order by v0\n           )) A, \n       ( SELECT ROWNUM IDX, TRAN_TIME, MILI_SEC\n           FROM (\n                   SELECT TRAN_TIME, CNT-NUM MILI_SEC\n                    FROM (\n                    select TRAN_TIME, sum(cnt) CNT\n                      from ( \n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1','CUSTOMER')   \n                           AND A.OWNER_CODE = 'PROD'\n                          AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= TO_CHAR(SYSDATE-1/24,'YYYYMMDDHH24')||'000000'\n                           AND A.TRAN_TIME <  TO_CHAR(SYSDATE,'YYYYMMDDHH24')||'000000'\n                           AND B.TABLE_NAME='H_EDI_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                         GROUP BY A.TRAN_TIME\n                         union\n                        SELECT A.TRAN_TIME, COUNT(*) CNT\n                          FROM MWIPLOTHIS A \n                             , CWIPSITDEF B\n                             , CEDILOTHIS C\n                             , V_CLOTWAFQTY D\n                         WHERE 1 = 1\n                           AND A.FACTORY IN ('HMKA1', 'HMKT1') --,'CUSTOMER')    \n                           AND A.OWNER_CODE = 'PROD'\n                           AND A.LOT_TYPE = 'W'\n                           AND A.HIST_DEL_FLAG = ' '\n                           AND A.LOT_CMF_2 = 'SE'\n                           AND A.TRAN_TIME >= :todayHH24_1 ||'000000'\n                           AND A.TRAN_TIME <  :todayHH24 ||'000000'\n                           AND B.TABLE_NAME='H_EDI_EX_TRAN'\n                           AND B.KEY_1='SE'\n                           AND A.TRAN_CODE = B.KEY_2   \n                           AND B.DATA_1 <> ' '   \n                           AND B.FACTORY = 'HMKA1'\n                           AND (A.TRAN_CODE <> 'START' OR A.TRAN_CMF_1 IN ('ISSUE','CLOSE'))\n                           AND (A.TRAN_CODE <> 'ADAPT' OR A.ADD_ORDER_ID_2 NOT IN ('MULTIEQP_MOT','MULTIEQP', ' ') OR A.TRAN_CMF_1 IN ('PART_CHANGE' ))\n                           AND A.OLD_FLOW > ' '\n                           AND A.LOT_ID = C.LOT_ID\n                           AND A.HIST_SEQ = C.HIST_SEQ\n                           AND A.TRAN_TIME  = C.TRAN_TIME\n                           AND A.LOT_ID = D.LOT_ID(+)\n                           AND A.OPER NOT IN ('T000N')\n                           GROUP BY A.TRAN_TIME\n                           )\n                           group by TRAN_TIME\n                         ) A, COPY_T B\n                   WHERE NUM < 26 \n                     AND NUM <= CNT\n                   ORDER BY TRAN_TIME, CNT-NUM \n                  )) B\n             WHERE A.IDX=B.IDX","CREATE_USER":"6","CREATE_DATE":"2021-10-15 03:34:51","DBTYPE":"MES"}]
2021-11-19 16:45:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 16:45:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:45:01 [EDI System] info: id: 677, name: nLOTEVENT_HM2021111916, query: '본문', process_id: 135
2021-11-19 16:45:16 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 16:45:16 [EDI System] info: Update successful 
2021-11-19 16:45:16 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=1132, RESULT=SUCCESS
    WHERE id=677
2021-11-19 16:45:16 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 16:45:17 [EDI System] info: [{"ID":"112","CFG_ID":"135","ITEM":"start","SET_TYPE":null,"VALUE":null,"NOTE":"4공백","UPDATE_USER":"6","UPDATE_DATE":"2021-08-20 04:25:53","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"113","CFG_ID":"135","ITEM":"end","SET_TYPE":null,"VALUE":null,"NOTE":null,"UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"},{"ID":"114","CFG_ID":"135","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"8공백","UPDATE_USER":"6","UPDATE_DATE":"2021-11-17 02:41:11","CREATE_USER":"6","CREATE_DATE":"2021-08-13 11:52:11"}]
2021-11-19 16:45:17 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 16:45:17 [EDI System] info: []
2021-11-19 16:45:17 [EDI System] info: TEST!!!!!
2021-11-19 16:45:17 [EDI System] info: []
2021-11-19 16:45:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:17 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:45:17 [EDI System] info: [{"ID":"677"}]
2021-11-19 16:45:17 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 677
2021-11-19 16:45:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:45:17 [EDI System] info: [{"ID":"677"}]
2021-11-19 16:45:17 [EDI System] info: saveAllLogger > name: nLOTEVENT_HM2021111916 / ID: 677
2021-11-19 16:45:17 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:45:17 [EDI System] info: Insert successful 
2021-11-19 16:45:17 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 16:45:17 [EDI System] info: Insert successful 
2021-11-19 16:45:17 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 16:45:17 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 16:45:18 [EDI System] info: Update successful 
2021-11-19 16:45:18 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 16:45:18 [EDI System] info: Insert successful 
2021-11-19 16:46:00 [EDI System] info: Job Start Time > {"min":46,"hour":16,"date":19,"month":11,"day":5}
 {"ID":107,"CFG_ID":"143","FILE_NAME":"nCMWIPINF_HM:todayHH24","FILE_DESC":"SEC CMWIPINF 1/1HR","FILE_SAVE_FOLDER":"D:/HM_EDI/SEC/OUT","FILE_CHARSET":"ascii","FILE_TYPE":"ff","DATA_TYPE":"text","FTP_ENV_ID":"100","SEND_FLAG":"Y","NODATASEND":"false","SCHEDULE_MIN":"46","SCHEDULE_HOUR":"*","SCHEDULE_DAY":"*","SCHEDULE_WEEK":"*","SCHEDULE_MONTH":"*","CM_F01":null,"CM_F02":null,"CREATE_DATE":"2021-11-12 05:17:07","CREATE_USER":"6","UPDATE_DATE":"2021-11-19 04:45:47","UPDATE_USER":"6","DELETE_DATE":null,"DELETE_USER":null,"frequency":"46 * * * *"}
2021-11-19 16:46:00 [EDI System] info: undefined >>> makeFileText Function Execute
2021-11-19 16:46:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:46:00 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:46:00 [EDI System] info: [{"ID":"678"}]
2021-11-19 16:46:00 [EDI System] info: saveAllLogger > name: nCMWIPINF_HM:todayHH24 / ID: 678
2021-11-19 16:46:00 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:46:00 [EDI System] info: Insert successful 
2021-11-19 16:46:00 [EDI System] info: 
    SELECT *
    FROM (
        SELECT ROWNUM,A.*
            FROM EDI_QUERY_SETTING A
            WHERE SETTING_ID = :id
            AND TYPE='Main'
            ORDER BY ID DESC
        ) 
    WHERE ROWNUM='1'
    
2021-11-19 16:46:01 [EDI System] info: [{"ROWNUM":1,"ID":"140","SETTING_ID":"143","KEY":null,"TYPE":"Main","QUERY":"SELECT\n  RPAD(VR_1,  5, ' ')\n, RPAD(VR_2, 30, ' ')\n, RPAD(VR_3, 15, ' ')\n, RPAD(VR_4, 15, ' ')\n, RPAD(VR_5,  2, ' ')\n, RPAD(VR_6,  2, ' ')\n, RPAD(VR_7, 20, ' ')\n, RPAD(VR_8, 30, ' ')\n, RPAD(VR_9, 16, ' ')\n, RPAD(VR_10, 24, ' ')\n, RPAD(VR_11, 14, ' ')\n, RPAD(VR_12,  4, ' ')\n, RPAD(VR_13,  4, ' ')\n, RPAD(VR_14, 10, ' ')\n, RPAD(VR_15, 10, ' ')\n, RPAD(VR_16,  1, ' ')\n, RPAD(VR_17,  2, ' ')\n, RPAD(VR_18, 10, ' ')\n, RPAD(VR_19, 14, ' ')\n, RPAD(VR_20, 20, ' ')\n, RPAD(VR_21, 20, ' ')\n, RPAD(VR_22, 20, ' ')\n, RPAD(VR_23, 20, ' ')\n, RPAD(VR_24, 20, ' ')\n, RPAD(VR_25, 10, ' ')\n, RPAD(VR_26, 10, ' ')\n, RPAD(VR_27,  1, ' ')\n, RPAD(VR_28, 65, ' ')\n, RPAD(VR_29, 14, ' ')\n, RPAD(VR_30,  8, ' ')\n, RPAD(VR_31, 1024, ' ')\nFROM \n(\nSELECT 'LS1HM'   VR_1\n , NVL((SELECT MAT_CMF_7 FROM MWIPMATDEF WHERE FACTORY = A.FACTORY AND MAT_ID = A.MAT_ID AND MAT_VER = A.MAT_VER), '-')   VR_2\n , F_GET_ASSY_RUNID(' ', A.LOT_ID, A.LOT_CMF_4)   VR_3\n , NVL(TRIM(A.LOT_CMF_1), '-')   VR_4\n , NVL(TRIM(A.LOT_CMF_5),'-')   VR_5\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'RTN_TYPE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '**')   VR_6\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'HGAK','TZ010HKAB', 'BASIC',\n     DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','BASIC','HMK3','BASIC','HMK9','BASIC','HMK4','BASIC',\n                  NVL(FLOW, '-')))   VR_7\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', '0008','TZ010HKAB', '0003',\n     TRIM(DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','0002','HMK3','0003','HMK9','0006','HMK4','0007',\n                  LPAD((SELECT SEQ_NUM-1 FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND FLOW = A.FLOW AND OPER = A.OPER),4,'0'))))   VR_8\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', '8','TZ010HKAB', '3',\n     NVL((SELECT SEQ_NUM-1 FROM MWIPFLWOPR WHERE FACTORY = A.FACTORY AND FLOW = A.FLOW AND OPER = A.OPER), '0'))   VR_9\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'PACKING','TZ010HKAB', 'Assy Final Stock',\n     DECODE(NVL((SELECT SEC_OPER FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-'),\n                  'HMK2','Assy Home Stock','HMK3','Assy Final Stock','HMK9','Test Home Stock','HMK4','Test Final Stock',\n                  NVL((SELECT OPER_DESC FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-')))   VR_10\n , A.OPER_IN_TIME    VR_11\n , DECODE(A.OPER||A.FLOW,'T1300HKAB', 'ASSY','TZ010HKAB', 'ASSY', DECODE(A.FACTORY, 'HMKT1', 'TEST', 'HMKA1', 'ASSY', '-'))    VR_12\n , NVL((SELECT DECODE(A.OPER||A.FLOW,'TZ010HKAB', SEC_OPER_AREA_COB ,SEC_OPER_AREA) FROM V_MWIPOPRDEF_SEC WHERE FACTORY = A.FACTORY AND OPER = A.OPER ), '-')   VR_13\n , NVL(TRIM(A.QTY_1), 0)   VR_14\n , NVL(TRIM(A.QTY_2), 0)   VR_15\n , 'C'     VR_16\n , F_GET_HOLD_FLAG_CODE(A.LOT_ID, A.MAT_ID, A.HOLD_FLAG, A.HOLD_CODE, 'FLAG' )    VR_17\n , F_GET_HOLD_FLAG_CODE(A.LOT_ID, A.MAT_ID, A.HOLD_FLAG, A.HOLD_CODE, 'CODE' )    VR_18\n , DECODE(A.HOLD_FLAG, 'Y', A.LAST_TRAN_TIME, ' ')    VR_19\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCFCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_20\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCACODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_21\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCTCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_22\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'NCQCODE' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_23\n , NVL((SELECT ATTR_VALUE FROM MATRNAMSTS WHERE FACTORY = A.FACTORY AND ATTR_TYPE = 'LOT_SEC_INFO' AND ATTR_NAME = 'OTHER' AND ATTR_KEY = TRIM(A.LOT_CMF_1)), '*')   VR_24\n , NVL((SELECT SUM(DECODE(TRAN_CODE, 'LOSS', (OLD_QTY_1 - QTY_1), QTY_1)) \n               FROM MWIPLOTHIS \n              WHERE LOT_ID = A.LOT_ID \n                AND TRAN_CODE IN ('LOSS', 'TERMINATE')\n                AND HIST_DEL_FLAG = ' '\n                AND TRAN_TIME BETWEEN F_GET_TIME(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'SE') \n                                  AND TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')), 0)         VR_25\n , NVL((SELECT SUM(TOTAL_BONUS_QTY) \n               FROM MWIPLOTBNS \n              WHERE LOT_ID = A.LOT_ID\n                AND TRAN_TIME BETWEEN F_GET_TIME(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'SE') \n                                  AND TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')), 0)    VR_26\n , '-'    VR_27\n , '-'    VR_28\n , TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')     VR_29\n , GET_WORK_DATE_EDI(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),'D')  VR_30\n , MESMGR.PK_SEC_MES_IF.MakeInkless_OMS_WIP(A.FACTORY, A.LOT_ID)  VR_31\n  FROM MWIPLOTSTS A\n WHERE 1 = 1\n   AND FACTORY IN ('HMKT1','HMKA1') \n   AND LOT_CMF_2 = 'SE'   \n   AND OWNER_CODE = 'PROD'\n   AND LOT_TYPE = 'W'\n   AND LOT_DEL_FLAG = ' ' \n   AND CREATE_CODE <> 'FREE' \n   AND MAT_ID LIKE 'SE'||(SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME = 'H_SPECIAL_CHAR' AND KEY_1 = '1')\n   AND OPER BETWEEN 'A0000' AND 'TZ010'\n   AND MAT_ID NOT LIKE 'SEKY'||(SELECT DATA_1 FROM MGCMTBLDAT WHERE FACTORY = 'HMKA1' AND TABLE_NAME = 'H_SPECIAL_CHAR' AND KEY_1 = '1')  --- 영업  요청으로 하드코딩 170412. SEKY%\n)","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:33:13","DBTYPE":"MES"}]
2021-11-19 16:46:01 [EDI System] info: 
        SELECT * FROM (
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = (
                SELECT ID
                FROM CG_CUSTOMER 
                WHERE PARENT = (
                    SELECT ID
                    FROM CG_CUSTOMER 
                    WHERE ID=(
                        SELECT PARENT
                        FROM CG_CUSTOMER 
                        WHERE ID=(
                            SELECT PARENT 
                            FROM CG_CUSTOMER 
                            WHERE ID=:id
                        )
                    )
                )
                AND LOWER(NAME) = 'common'
            )
            AND TYPE IN ('DB','TEXT')
            AND KEY NOT IN (SELECT KEY
                            FROM EDI_QUERY_SETTING
                            WHERE 1=1
                            AND SETTING_ID = :id
                            AND TYPE IN ('DB','TEXT'))
            UNION ALL
            SELECT *
            FROM EDI_QUERY_SETTING
            WHERE 1=1
            AND SETTING_ID = :id
            AND TYPE IN ('DB','TEXT')
        )
        ORDER BY LENGTH(KEY) DESC
    
2021-11-19 16:46:01 [EDI System] info: [{"ID":"137","SETTING_ID":"129","KEY":"todayHH24MISS","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-12 05:20:22","DBTYPE":"MES"},{"ID":"124","SETTING_ID":"129","KEY":"todayHH24_1","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE - 1/24,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 01:40:03","DBTYPE":"MES"},{"ID":"122","SETTING_ID":"129","KEY":"todayHH24","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-10-15 11:47:10","DBTYPE":"MES"},{"ID":"115","SETTING_ID":"129","KEY":"today_yy","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-09-24 08:46:51","DBTYPE":"MES"},{"ID":"130","SETTING_ID":"129","KEY":"today","TYPE":"DB","QUERY":"select TO_CHAR(SYSDATE,'YYYYMMDDHH24') value from dual","CREATE_USER":"6","CREATE_DATE":"2021-11-09 03:36:41","DBTYPE":"MES"}]
2021-11-19 16:46:01 [EDI System] info: id: 678, name: nCMWIPINF_HM2021111916, query: '본문', process_id: 143
2021-11-19 16:47:21 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=:row_count, RESULT=:result
    WHERE id=:id
2021-11-19 16:47:21 [EDI System] info: Update successful 
2021-11-19 16:47:21 [EDI System] info: UPDATE EDI_LOG_QUERY 
    SET END_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), ROW_COUNT=4881, RESULT=SUCCESS
    WHERE id=678
2021-11-19 16:47:21 [EDI System] info: 
    SELECT *
    FROM EDI_ENV_SETTING WHERE CFG_ID=:id
    
2021-11-19 16:47:22 [EDI System] info: [{"ID":"118","CFG_ID":"143","ITEM":"between","SET_TYPE":null,"VALUE":null,"NOTE":"COMMA","UPDATE_USER":"6","UPDATE_DATE":"2021-11-18 12:09:41","CREATE_USER":"6","CREATE_DATE":"2021-11-17 02:42:44"}]
2021-11-19 16:47:22 [EDI System] info: 
  SELECT *
  FROM EDI_FILE_HEADNTAIL WHERE CFG_ID=:id
  
2021-11-19 16:47:22 [EDI System] info: [{"ID":"110","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"CMWIPINF","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:41:42","DELETE_DATE":null,"DELETE_USER":null},{"ID":"111","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"HANAMICRON","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:41:43","DELETE_DATE":null,"DELETE_USER":null},{"ID":"112","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"1001","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:42:34","DELETE_DATE":null,"DELETE_USER":null},{"ID":"113","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"HM:today","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:09","DELETE_DATE":null,"DELETE_USER":null},{"ID":"114","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"MDH1","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:09","DELETE_DATE":null,"DELETE_USER":null},{"ID":"115","CFG_ID":"143","DATA_TYPE":"t_text","NOTE":"New Note","VALUE":"MDT1","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:27","DELETE_DATE":null,"DELETE_USER":null}]
2021-11-19 16:47:22 [EDI System] info: TEST!!!!!
2021-11-19 16:47:22 [EDI System] info: [{"ID":"110","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"CMWIPINF","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:41:42","DELETE_DATE":null,"DELETE_USER":null},{"ID":"111","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"HANAMICRON","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:41:43","DELETE_DATE":null,"DELETE_USER":null},{"ID":"112","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"1001","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:42:34","DELETE_DATE":null,"DELETE_USER":null},{"ID":"113","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"HM:today","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:09","DELETE_DATE":null,"DELETE_USER":null},{"ID":"114","CFG_ID":"143","DATA_TYPE":"h_text","NOTE":"New Note","VALUE":"MDH1","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:09","DELETE_DATE":null,"DELETE_USER":null},{"ID":"115","CFG_ID":"143","DATA_TYPE":"t_text","NOTE":"New Note","VALUE":"MDT1","CM_F01":null,"CM_F02":null,"UPDATE_USER":null,"UPDATE_DATE":null,"CREATE_USER":"6","CREATE_DATE":"2021-11-18 01:43:27","DELETE_DATE":null,"DELETE_USER":null}]
2021-11-19 16:47:22 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:47:22 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:47:22 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:47:22 [EDI System] info: SELECT (CASE WHEN :ID LIKE 'EDI%' THEN TO_CHAR(EDI_GET_SEQ(:id)) ELSE :ID END) AS ID FROM DUAL
2021-11-19 16:47:22 [EDI System] info: [{"ID":"678"}]
2021-11-19 16:47:22 [EDI System] info: saveAllLogger > name: nCMWIPINF_HM2021111916 / ID: 678
2021-11-19 16:47:22 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:47:22 [EDI System] info: [{"ID":"678"}]
2021-11-19 16:47:22 [EDI System] info: saveAllLogger > name: nCMWIPINF_HM2021111916 / ID: 678
2021-11-19 16:47:22 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, DESCRIPTION, CREATE_USER, CREATE_DATE)
    VALUES(:id, EDI_GET_STEP(:stepId), :name, :process_id, :description, 'DAEMON', TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'))
2021-11-19 16:47:22 [EDI System] info: Insert successful 
2021-11-19 16:47:22 [EDI System] info: 
    SELECT * FROM EDI_FTP_SETTING WHERE ID=:id  AND ROWNUM=1
    
2021-11-19 16:47:22 [EDI System] info: Insert successful 
2021-11-19 16:47:23 [EDI System] info: [{"ID":"100","CFG_ID":"129","FTP_ADDR":"211.180.182.7","USER_ID":"WI","PWD":"WI120423","BASE_DIR":"./out","TYPE":"SFTP","UPDATE_USER":"6","UPDATE_DATE":"2021-11-12 02:21:59","CREATE_USER":"6","CREATE_DATE":"2021-06-04 12:05:31"}]
2021-11-19 16:47:24 [EDI System] info: UPDATE EDI_LOG SET RESULT = 'SUCCESS', LOG_TIME=TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') WHERE ID=:id
2021-11-19 16:47:24 [EDI System] info: Update successful 
2021-11-19 16:47:24 [EDI System] info: INSERT INTO EDI_LOG(ID, STEP, NAME, PROCESS_ID, RESULT, LOG_TIME, DESCRIPTION, CREATE_USER)
    VALUES(:id, EDI_GET_STEP(:step_id), :name, :process_id, :result, TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS'), :description, 'DAEMON')
2021-11-19 16:47:24 [EDI System] info: Insert successful 
